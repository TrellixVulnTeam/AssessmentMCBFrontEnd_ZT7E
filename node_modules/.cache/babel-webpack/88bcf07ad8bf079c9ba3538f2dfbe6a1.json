{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { Injectable, EventEmitter, Directive, Input, Output, HostListener, NgModule } from '@angular/core';\nimport { saveAs } from 'file-saver';\nimport * as i2 from '@angular/common/http';\nimport { HttpParams } from '@angular/common/http';\n\nclass FileSaverService {\n  get isFileSaverSupported() {\n    try {\n      return !!new Blob();\n    } catch (e) {\n      return false;\n    }\n  }\n\n  genType(fileName) {\n    if (!fileName || fileName.lastIndexOf('.') === -1) {\n      return 'text/plain';\n    }\n\n    const type = fileName.substr(fileName.lastIndexOf('.') + 1);\n\n    switch (type) {\n      case 'txt':\n        return 'text/plain';\n\n      case 'xml':\n      case 'html':\n        return `text/${type}`;\n\n      case 'json':\n        return 'octet/stream';\n\n      default:\n        return `application/${type}`;\n    }\n  }\n\n  save(blob, fileName, filtType, option) {\n    if (!blob) {\n      throw new Error('Data argument should be a blob instance');\n    }\n\n    const file = new Blob([blob], {\n      type: filtType || blob.type || this.genType(fileName)\n    });\n    saveAs(file, decodeURI(fileName || 'download'), option);\n  }\n\n  saveText(txt, fileName, option) {\n    const blob = new Blob([txt]);\n    this.save(blob, fileName, undefined, option);\n  }\n\n}\n\nFileSaverService.ɵfac = i0.ɵɵngDeclareFactory({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverService,\n  deps: [],\n  target: i0.ɵɵFactoryTarget.Injectable\n});\nFileSaverService.ɵprov = i0.ɵɵngDeclareInjectable({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverService,\n  providedIn: 'root'\n});\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverService,\n  decorators: [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }]\n});\n\nclass FileSaverDirective {\n  constructor(el, fss, httpClient) {\n    this.el = el;\n    this.fss = fss;\n    this.httpClient = httpClient;\n    this.method = 'GET';\n    this.success = new EventEmitter();\n    this.error = new EventEmitter();\n\n    if (!fss.isFileSaverSupported) {\n      el.nativeElement.classList.add(`filesaver__not-support`);\n    }\n  }\n\n  getName(res) {\n    return decodeURI(this.fileName || res.headers.get('filename') || res.headers.get('x-filename') || '');\n  }\n\n  _click() {\n    if (!this.fss.isFileSaverSupported) {\n      return;\n    }\n\n    let req = this.http;\n\n    if (!req) {\n      let params = new HttpParams();\n      const query = this.query || {}; // tslint:disable-next-line:forin\n\n      for (const item in query) {\n        params = params.set(item, query[item]);\n      }\n\n      req = this.httpClient.request(this.method, this.url, {\n        observe: 'response',\n        responseType: 'blob',\n        headers: this.header,\n        params\n      });\n    }\n\n    this.setDisabled(true);\n    req.subscribe(res => {\n      if (res.status !== 200 || res.body.size <= 0) {\n        this.error.emit(res);\n        return;\n      }\n\n      this.fss.save(res.body, this.getName(res), undefined, this.fsOptions);\n      this.success.emit(res);\n    }, err => this.error.emit(err), () => this.setDisabled(false));\n  }\n\n  setDisabled(status) {\n    const el = this.el.nativeElement;\n    el.disabled = status;\n    el.classList[status ? 'add' : 'remove'](`filesaver__disabled`);\n  }\n\n}\n\nFileSaverDirective.ɵfac = i0.ɵɵngDeclareFactory({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverDirective,\n  deps: [{\n    token: i0.ElementRef\n  }, {\n    token: FileSaverService\n  }, {\n    token: i2.HttpClient\n  }],\n  target: i0.ɵɵFactoryTarget.Directive\n});\nFileSaverDirective.ɵdir = i0.ɵɵdefineDirective({\n  type: FileSaverDirective,\n  selectors: [[\"\", \"fileSaver\", \"\"]],\n  hostBindings: function FileSaverDirective_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"click\", function FileSaverDirective_click_HostBindingHandler() {\n        return ctx._click();\n      });\n    }\n  },\n  inputs: {\n    method: \"method\",\n    http: \"http\",\n    query: \"query\",\n    header: \"header\",\n    url: \"url\",\n    fileName: \"fileName\",\n    fsOptions: \"fsOptions\"\n  },\n  outputs: {\n    success: \"success\",\n    error: \"error\"\n  },\n  exportAs: [\"fileSaver\"]\n});\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverDirective,\n  decorators: [{\n    type: Directive,\n    args: [{\n      selector: '[fileSaver]',\n      exportAs: 'fileSaver'\n    }]\n  }],\n  ctorParameters: function () {\n    return [{\n      type: i0.ElementRef\n    }, {\n      type: FileSaverService\n    }, {\n      type: i2.HttpClient\n    }];\n  },\n  propDecorators: {\n    method: [{\n      type: Input\n    }],\n    http: [{\n      type: Input\n    }],\n    query: [{\n      type: Input\n    }],\n    header: [{\n      type: Input\n    }],\n    url: [{\n      type: Input\n    }],\n    fileName: [{\n      type: Input\n    }],\n    fsOptions: [{\n      type: Input\n    }],\n    success: [{\n      type: Output\n    }],\n    error: [{\n      type: Output\n    }],\n    _click: [{\n      type: HostListener,\n      args: ['click']\n    }]\n  }\n});\n\nclass FileSaverModule {}\n\nFileSaverModule.ɵfac = i0.ɵɵngDeclareFactory({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverModule,\n  deps: [],\n  target: i0.ɵɵFactoryTarget.NgModule\n});\nFileSaverModule.ɵmod = i0.ɵɵngDeclareNgModule({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverModule,\n  declarations: [FileSaverDirective],\n  exports: [FileSaverDirective]\n});\nFileSaverModule.ɵinj = i0.ɵɵngDeclareInjector({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverModule\n});\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"12.0.2\",\n  ngImport: i0,\n  type: FileSaverModule,\n  decorators: [{\n    type: NgModule,\n    args: [{\n      declarations: [FileSaverDirective],\n      exports: [FileSaverDirective]\n    }]\n  }]\n});\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { FileSaverDirective, FileSaverModule, FileSaverService }; //# sourceMappingURL=ngx-filesaver.js.map","map":{"version":3,"sources":["D:/FrontEndWS/super-duper-telegram-master/node_modules/ngx-filesaver/fesm2015/ngx-filesaver.js"],"names":["i0","Injectable","EventEmitter","Directive","Input","Output","HostListener","NgModule","saveAs","i2","HttpParams","FileSaverService","isFileSaverSupported","Blob","e","genType","fileName","lastIndexOf","type","substr","save","blob","filtType","option","Error","file","decodeURI","saveText","txt","undefined","ɵfac","ɵɵngDeclareFactory","minVersion","version","ngImport","deps","target","ɵɵFactoryTarget","ɵprov","ɵɵngDeclareInjectable","providedIn","ɵɵngDeclareClassMetadata","decorators","args","FileSaverDirective","constructor","el","fss","httpClient","method","success","error","nativeElement","classList","add","getName","res","headers","get","_click","req","http","params","query","item","set","request","url","observe","responseType","header","setDisabled","subscribe","status","body","size","emit","fsOptions","err","disabled","token","ElementRef","HttpClient","ɵdir","selector","exportAs","ctorParameters","propDecorators","FileSaverModule","ɵmod","ɵɵngDeclareNgModule","declarations","exports","ɵinj","ɵɵngDeclareInjector"],"mappings":"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","sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, EventEmitter, Directive, Input, Output, HostListener, NgModule } from '@angular/core';\nimport { saveAs } from 'file-saver';\nimport * as i2 from '@angular/common/http';\nimport { HttpParams } from '@angular/common/http';\n\nclass FileSaverService {\n    get isFileSaverSupported() {\n        try {\n            return !!new Blob();\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    genType(fileName) {\n        if (!fileName || fileName.lastIndexOf('.') === -1) {\n            return 'text/plain';\n        }\n        const type = fileName.substr(fileName.lastIndexOf('.') + 1);\n        switch (type) {\n            case 'txt':\n                return 'text/plain';\n            case 'xml':\n            case 'html':\n                return `text/${type}`;\n            case 'json':\n                return 'octet/stream';\n            default:\n                return `application/${type}`;\n        }\n    }\n    save(blob, fileName, filtType, option) {\n        if (!blob) {\n            throw new Error('Data argument should be a blob instance');\n        }\n        const file = new Blob([blob], { type: filtType || blob.type || this.genType(fileName) });\n        saveAs(file, decodeURI(fileName || 'download'), option);\n    }\n    saveText(txt, fileName, option) {\n        const blob = new Blob([txt]);\n        this.save(blob, fileName, undefined, option);\n    }\n}\nFileSaverService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nFileSaverService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverService, providedIn: 'root' });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverService, decorators: [{\n            type: Injectable,\n            args: [{ providedIn: 'root' }]\n        }] });\n\nclass FileSaverDirective {\n    constructor(el, fss, httpClient) {\n        this.el = el;\n        this.fss = fss;\n        this.httpClient = httpClient;\n        this.method = 'GET';\n        this.success = new EventEmitter();\n        this.error = new EventEmitter();\n        if (!fss.isFileSaverSupported) {\n            el.nativeElement.classList.add(`filesaver__not-support`);\n        }\n    }\n    getName(res) {\n        return decodeURI(this.fileName || res.headers.get('filename') || res.headers.get('x-filename') || '');\n    }\n    _click() {\n        if (!this.fss.isFileSaverSupported) {\n            return;\n        }\n        let req = this.http;\n        if (!req) {\n            let params = new HttpParams();\n            const query = this.query || {};\n            // tslint:disable-next-line:forin\n            for (const item in query) {\n                params = params.set(item, query[item]);\n            }\n            req = this.httpClient.request(this.method, this.url, {\n                observe: 'response',\n                responseType: 'blob',\n                headers: this.header,\n                params,\n            });\n        }\n        this.setDisabled(true);\n        req.subscribe((res) => {\n            if (res.status !== 200 || res.body.size <= 0) {\n                this.error.emit(res);\n                return;\n            }\n            this.fss.save(res.body, this.getName(res), undefined, this.fsOptions);\n            this.success.emit(res);\n        }, (err) => this.error.emit(err), () => this.setDisabled(false));\n    }\n    setDisabled(status) {\n        const el = this.el.nativeElement;\n        el.disabled = status;\n        el.classList[status ? 'add' : 'remove'](`filesaver__disabled`);\n    }\n}\nFileSaverDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverDirective, deps: [{ token: i0.ElementRef }, { token: FileSaverService }, { token: i2.HttpClient }], target: i0.ɵɵFactoryTarget.Directive });\nFileSaverDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"12.0.0\", version: \"12.0.2\", type: FileSaverDirective, selector: \"[fileSaver]\", inputs: { method: \"method\", http: \"http\", query: \"query\", header: \"header\", url: \"url\", fileName: \"fileName\", fsOptions: \"fsOptions\" }, outputs: { success: \"success\", error: \"error\" }, host: { listeners: { \"click\": \"_click()\" } }, exportAs: [\"fileSaver\"], ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverDirective, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: '[fileSaver]',\n                    exportAs: 'fileSaver',\n                }]\n        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: FileSaverService }, { type: i2.HttpClient }]; }, propDecorators: { method: [{\n                type: Input\n            }], http: [{\n                type: Input\n            }], query: [{\n                type: Input\n            }], header: [{\n                type: Input\n            }], url: [{\n                type: Input\n            }], fileName: [{\n                type: Input\n            }], fsOptions: [{\n                type: Input\n            }], success: [{\n                type: Output\n            }], error: [{\n                type: Output\n            }], _click: [{\n                type: HostListener,\n                args: ['click']\n            }] } });\n\nclass FileSaverModule {\n}\nFileSaverModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nFileSaverModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverModule, declarations: [FileSaverDirective], exports: [FileSaverDirective] });\nFileSaverModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverModule });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.2\", ngImport: i0, type: FileSaverModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    declarations: [FileSaverDirective],\n                    exports: [FileSaverDirective],\n                }]\n        }] });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { FileSaverDirective, FileSaverModule, FileSaverService };\n//# sourceMappingURL=ngx-filesaver.js.map\n"]},"metadata":{},"sourceType":"module"}